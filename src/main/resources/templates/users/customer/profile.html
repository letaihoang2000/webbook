<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>My Profile - BookSaw</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="_csrf" th:content="${_csrf.token}" content=""/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}" content=""/>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/normalize.css}">
    <link rel="stylesheet" th:href="@{/icomoon/icomoon.css}">
    <link rel="stylesheet" th:href="@{/css/vendor.css}">
    <link rel="stylesheet" th:href="@{/css/customer/home.css}">
    <link rel="stylesheet" th:href="@{/css/customer/navbar.css}">
    <link rel="stylesheet" th:href="@{/css/customer/profile.css}">
    <link rel="stylesheet" th:href="@{/css/customer/navbar-badges.css}">
    <link rel="stylesheet" th:href="@{/css/customer/toast-notifications.css}">
</head>

<body data-bs-spy="scroll" data-bs-target="#header" tabindex="0">

<!-- Include Navbar Fragment -->
<div th:replace="~{fragments/customer_navbar :: navbar}"></div>

<!-- Profile Header Section -->
<section id="profile-header" class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="section-header align-center">
                    <div class="title">
                        <span>Account Settings</span>
                    </div>
                    <h2 class="section-title">My Profile</h2>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Profile Content Section -->
<section id="profile-content" class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10">
                <!-- Profile Card (Read-Only View) -->
                <div class="profile-card">
                    <!-- Profile Header with Avatar -->
                    <div class="profile-header">
                        <div class="avatar-container">
                            <img th:src="${currentUser.image != null && !currentUser.image.isEmpty()}
                                        ? ${currentUser.image}
                                        : @{/images/default-avatar.png}"
                                 alt="Profile Picture"
                                 class="profile-avatar"
                                 id="displayAvatar">
                        </div>
                        <div class="profile-info">
                            <h3 id="displayFullName" th:text="${currentUser.first_name + ' ' + currentUser.last_name}">User Name</h3>
                            <p class="text-muted" id="displayEmail" th:text="${currentUser.email}">user@email.com</p>
                        </div>
                    </div>

                    <!-- Profile Details (Read-Only) -->
                    <div class="profile-body">
                        <div class="profile-details">
                            <!-- First Name -->
                            <div class="detail-item">
                                <label class="detail-label">
                                    <i class="icon icon-user"></i> First Name
                                </label>
                                <p class="detail-value" id="displayFirstName" th:text="${currentUser.first_name}">-</p>
                            </div>

                            <!-- Last Name -->
                            <div class="detail-item">
                                <label class="detail-label">
                                    <i class="icon icon-user"></i> Last Name
                                </label>
                                <p class="detail-value" id="displayLastName" th:text="${currentUser.last_name}">-</p>
                            </div>

                            <!-- Email -->
                            <div class="detail-item">
                                <label class="detail-label">
                                    <i class="icon icon-envelope"></i> Email
                                </label>
                                <p class="detail-value" th:text="${currentUser.email}">-</p>
                            </div>

                            <!-- Mobile -->
                            <div class="detail-item">
                                <label class="detail-label">
                                    <i class="icon icon-phone"></i> Mobile
                                </label>
                                <p class="detail-value" id="displayMobile" th:text="${currentUser.mobile != null && !currentUser.mobile.isEmpty()} ? ${currentUser.mobile} : 'Not provided'">-</p>
                            </div>

                            <!-- Address -->
                            <div class="detail-item">
                                <label class="detail-label">
                                    <i class="icon icon-location"></i> Address
                                </label>
                                <p class="detail-value" id="displayAddress" th:text="${currentUser.address != null && !currentUser.address.isEmpty()} ? ${currentUser.address} : 'Not provided'">-</p>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-3 justify-content-end mt-4">
                            <a th:href="@{/customer/home}" class="btn btn-outline-secondary" id="back-home-btn">
                                <i class="icon icon-arrow-left"></i> Back to Home
                            </a>
                            <button type="button" class="btn btn-accent" id="editProfileBtn">
                                <i class="icon icon-pencil"></i> Edit Profile
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer id="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <div class="footer-item">
                    <div class="company-brand">
                        <img th:src="@{/images/main-logo.png}" alt="logo" class="footer-logo">
                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="footer-menu">
                    <h5>About Us</h5>
                    <ul class="menu-list">
                        <li class="menu-item"><a href="#">vision</a></li>
                        <li class="menu-item"><a href="#">careers</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-2">
                <div class="footer-menu">
                    <h5>Discover</h5>
                    <ul class="menu-list">
                        <li class="menu-item"><a th:href="@{/customer/home}">Home</a></li>
                        <li class="menu-item"><a th:href="@{/customer/all-books}">Books</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-2">
                <div class="footer-menu">
                    <h5>My account</h5>
                    <ul class="menu-list">
                        <li class="menu-item"><a th:href="@{/customer/profile}">My Profile</a></li>
                        <li class="menu-item"><a th:href="@{/wishlist}">My Wishlist</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-2">
                <div class="footer-menu">
                    <h5>Help</h5>
                    <ul class="menu-list">
                        <li class="menu-item"><a href="#">Help center</a></li>
                        <li class="menu-item"><a href="#">Contact us</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>

<div id="footer-bottom">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="copyright">
                    <div class="row">
                        <div class="col-md-6">
                            <p>Â© 2022 All rights reserved.</p>
                        </div>
                        <div class="col-md-6">
                            <div class="social-links align-right">
                                <ul>
                                    <li><a href="#"><i class="icon icon-facebook"></i></a></li>
                                    <li><a href="#"><i class="icon icon-twitter"></i></a></li>
                                    <li><a href="#"><i class="icon icon-youtube-play"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Edit Profile Modal -->
<div th:replace="~{modals/customer/edit_profile :: editProfileModal}"></div>
<div th:replace="~{modals/customer/signout :: logoutModal}"></div>

<div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999;">
    <div id="successToast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                <i class="icon icon-check me-2"></i>
                <span id="toastMessage">Profile updated successfully!</span>
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>

<script th:src="@{/js/jquery-1.11.0.min.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        crossorigin="anonymous"></script>
<script th:src="@{/js/plugins.js}"></script>
<script th:src="@{/js/script.js}"></script>
<script th:src="@{/js/customer/signout.js}"></script>
<script th:src="@{/js/customer/profile.js}"></script>
<script th:src="@{/js/customer/cart.js}"></script>

<!-- Pass user data to JavaScript -->
<script th:inline="javascript">
    const currentUserData = {
        id: /*[[${currentUser.id}]]*/ '',
        first_name: /*[[${currentUser.first_name}]]*/ '',
        last_name: /*[[${currentUser.last_name}]]*/ '',
        email: /*[[${currentUser.email}]]*/ '',
        mobile: /*[[${currentUser.mobile}]]*/ '',
        address: /*[[${currentUser.address}]]*/ '',
        image: /*[[${currentUser.image}]]*/ ''
    };
</script>

</body>
</html>